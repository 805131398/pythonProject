<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="cache-control" content="no-cache">
    <meta http-equiv="expires" content="0">

    <!-- <title>USR-G810 - 总览</title> -->
    <title>总览</title>
    <!--[if lt IE 9]>
    <script src="/luci-static/bootstrap/html5.js"></script><![endif]-->
    <script type="text/javascript">
        document.write("<link rel='stylesheet' href='/luci-static/bootstrap/cascade.css?" + Math.random() + "'>");
    </script>
    <style title="text/css">
        .STYLE1 {
            color: #FFFFFF
        }
    </style>
    <link rel="stylesheet" media="only screen and (max-device-width: 854px)" href="/luci-static/bootstrap/mobile.css"
          type="text/css"/>
    <link rel="shortcut icon" href="/luci-static/bootstrap/favicon.ico">
    <script src="/luci-static/bootstrap/jquery-1.9.1.min.js"></script>
    <!-- <script src="/luci-static/bootstrap/jquery.cookie.js"></script> -->
    <script src="/luci-static/resources/xhr.js"></script>
</head>

<body class="lang_zh-cnOverview">
<div class="head">
    <div class="logo">
        <img src="/luci-static/bootstrap/logo.png" alt="logo">
        <div class="logo_wz">
            <h1>有人物联网</h1>
            <h4>工业物联网通信专家</h4>
        </div>
        <div class="logo_right">
            <div class="logo_culture">有人在认真做事！</div>
            <div class="pull-right">
            <span id="xhr_poll_status" style="display:none" onclick="XHR.running() ? XHR.halt() : XHR.run()"
                  style="float:left;">
              <span class="label success" id="xhr_poll_status_on">自动刷新 开</span>
              <span class="label" id="xhr_poll_status_off" style="display:none">自动刷新 关</span>
            </span>
                <a target="_top" id="lang_cn" href="/cgi-bin/luci_zhcn"><img src="/luci-static/bootstrap/cn.png"></a><a
                    target="_top" id="lang_en" href="/cgi-bin/luci_en"><img src="/luci-static/bootstrap/en.png"></a>
            </div>

        </div>
    </div>
</div>

<div class="main clearfix" id="main">
    <div class="main_left" id="main_left_head" style="position:absolute;z-index:-1"></div>
    <div class="main_left" id="main_left">
        <div class="number">USR-G810</div>
        <ul class="nav">
            <li class="dropdown" id="1-menu">
                <div class="nav_div"><span></span><a class="menu">状态</a></div>
                <ul class="dropdown-menu">
                    <li id="1-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/status/overview">总览</a>
                    </li>
                    <li id="1-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/status/routes">路由表</a>
                    </li>
                    <li id="1-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/status/iptables">防火墙</a>
                    </li>
                </ul>
            </li>

            <li class="dropdown" id="2-menu">
                <div class="nav_div"><span></span><a class="menu">服务</a></div>
                <ul class="dropdown-menu">
                    <li id="2-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/services/orayddns">花生壳内网穿透</a>
                    </li>
                    <li id="2-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/services/ddns">动态DNS</a>
                    </li>
                    <li id="2-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/services/remotem">远程管理</a>
                    </li>
                </ul>
            </li>

            <li class="dropdown" id="3-menu">
                <div class="nav_div"><span></span><a class="menu">VPN</a></div>
                <ul class="dropdown-menu">
                    <li id="3-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/vpn/pptp">PPTP</a>
                    </li>
                    <li id="3-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/vpn/l2tp">L2TP</a>
                    </li>
                    <li id="3-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/vpn/ipsec">IPSec</a>
                    </li>
                    <li id="3-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/vpn/openvpn">OpenVPN</a>
                    </li>
                    <li id="3-menu-1"><a href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/vpn/gre">GRE</a>
                    </li>
                    <li id="3-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/vpn/VPN status">VPN状态</a>
                    </li>
                </ul>
            </li>

            <li class="dropdown" id="4-menu">
                <div class="nav_div"><span></span><a class="menu">网络</a></div>
                <ul class="dropdown-menu">
                    <li id="4-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/network/network">接口</a>
                    </li>
                    <li id="4-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/network/5g_config">5G配置</a>
                    </li>
                    <li id="4-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/network/priority">网络切换</a>
                    </li>
                    <li id="4-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/network/wifi">无线配置</a>
                    </li>
                    <li id="4-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/network/dhcp">DHCP/DNS</a>
                    </li>
                    <li id="4-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/network/hosts">主机名</a>
                    </li>
                    <li id="4-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/network/routes">静态路由</a>
                    </li>
                    <li id="4-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/network/diagnostics">网络诊断</a>
                    </li>
                </ul>
            </li>

            <li class="dropdown" id="5-menu">
                <div class="nav_div"><span></span><a class="menu">防火墙</a></div>
                <ul class="dropdown-menu">
                    <li id="5-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/firewall/zones">基本设置</a>
                    </li>
                    <li id="5-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/firewall/forwards">端口转发</a>
                    </li>
                    <li id="5-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/firewall/rules">通信规则</a>
                    </li>
                    <li id="5-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/firewall/Restriction">访问限制</a>
                    </li>
                </ul>
            </li>

            <li class="dropdown" id="6-menu">
                <div class="nav_div"><span></span><a class="menu">系统</a></div>
                <ul class="dropdown-menu">
                    <li id="6-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/system/system">系统</a>
                    </li>
                    <li id="6-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/system/admin">管理权</a>
                    </li>
                    <li id="6-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/system/restart_timer">定时重启</a>
                    </li>
                    <li id="6-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/system/flashops">备份/升级</a>
                    </li>
                    <li id="6-menu-1"><a
                            href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/system/reboot">重启</a>
                    </li>
                </ul>
            </li>

            <li class="dropdown">
                <div class="nav_div2"><span></span><a
                        href="/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/logout">退出</a></div>
            </li>


        </ul>


    </div>
    <script>

        function setCookie(cvalue, exdays) {
            var d = new Date();
            d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
            var expires = "expires=" + d.toGMTString();
            document.cookie = "ckname" + "=" + cvalue + ";path=/";
        }

        function getCookie() {
            var name = "ckname" + "=";
            var decodedCookie = decodeURIComponent(document.cookie);
            var ca = decodedCookie.split(';');
            for (var i = 0; i < ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0) == ' ') {
                    c = c.substring(1);
                }
                if (c.indexOf(name) == 0) {
                    return c.substring(name.length, c.length);
                }
            }
            return "";
        }

        function isEmpty(obj) {
            if (typeof obj == "undefined" || obj == null || obj == "") {
                return true;
            } else {
                return false;
            }
        }

        var sub_menu = document.getElementById("main_left");

        var oUl = sub_menu.getElementsByTagName("ul")[0];
        var aLi = oUl.getElementsByTagName("li");
        for (var i = 0; i < aLi.length; i++) {
            var LiId = aLi[i].getAttribute("id");
            if (isEmpty(LiId)) {
                continue;
            }
            var Lisub_menu = document.getElementById(LiId);
            var LiUl = Lisub_menu.getElementsByTagName("ul")[0];
            if (isEmpty(LiUl)) {
                continue;
            }
            var LiDiv = Lisub_menu.getElementsByTagName("div")[0];
            var SaveLiId = getCookie();
            SaveLiId = SaveLiId.substr(0, LiId.length);
            if (SaveLiId == LiId) {
                LiUl.style.display = "block";
                $(LiDiv).toggleClass("add_show");
            } else {
                LiUl.style.display = "none";
                $(LiDiv).removeClass("add_show");
            }
        }

    </script>
    <script>

        $(function () {
            $(".nav_div").click(function () {

                $(this).toggleClass("add_show").siblings(".nav .nav_div").removeClass("add_show");

                <!-- Sets the time for the parent node to collapse and expand -->
                $(this).next(".dropdown-menu").slideToggle(300).siblings(".dropdown-menu").slideUp(300);
            })
        });

        $(function () {
            $(".dropdown-menu").click(function () {

                var parentnodeid = this.parentNode.getAttribute("id");

                setCookie(parentnodeid, 30);
            })
        });
    </script>
    <div class="main_right" id="main_right">
        <div class="usr_content">
            <div id="maincontent" class="container">

            </div>


            <script type="text/javascript" src="/luci-static/resources/cbi.js"></script>
            <script type="text/javascript">//<![CDATA[
            function progressbar(v, m) {
                var vn = parseInt(v) || 0;
                var mn = parseInt(m) || 100;
                var pc = Math.floor((100 / mn) * vn);

                return String.format(
                    '<div style="width:200px; position:relative; border:1px solid #999999">' +
                    '<div style="background-color:#CCCCCC; width:%d%%; height:15px">' +
                    '<div style="position:absolute; left:0; top:0; text-align:center; width:100%%; color:#000000">' +
                    '<small>%s / %s (%d%%)</small>' +
                    '</div>' +
                    '</div>' +
                    '</div>', pc, v, m, pc
                );
            }

            var wifidevs = null;
            var arptable = null;

            XHR.poll(5, '/cgi-bin/luci_zhcn/;stok=49379f1376e2a41b08ee6f95f9411568/admin/status/overview', {status: 1},
                function (x, info) {
                    var si = document.getElementById('wan4_i');
                    var ss = document.getElementById('wan4_s');
                    var ifc = info.wan;

                    if (ifc && ifc.ifname && ifc.proto != 'none') {
                        var s = String.format(
                            '<strong>类型: </strong>%s<br />' +
                            '<strong>地址: </strong>%s<br />' +
                            '<strong>子网掩码: </strong>%s<br />' +
                            '<strong>网关: </strong>%s<br />',
                            ifc.proto,
                            (ifc.ipaddr) ? ifc.ipaddr : '0.0.0.0',
                            (ifc.netmask && ifc.netmask != ifc.ipaddr) ? ifc.netmask : '255.255.255.255',
                            (ifc.gwaddr) ? ifc.gwaddr : '0.0.0.0'
                        );

                        for (var i = 0; i < ifc.dns.length; i++) {
                            s += String.format(
                                '<strong>DNS %d: </strong>%s<br />',
                                i + 1, ifc.dns[i]
                            );
                        }

                        if (ifc.expires > -1) {
                            s += String.format(
                                '<strong>到期时间: </strong>%t<br />',
                                ifc.expires
                            );
                        }

                        if (ifc.ifname == "eth1.2") {
                            s += String.format(
                                '<strong>RSSI: </strong>%s<br />',
                                info.sim.signal_intensity
                            );

                            s += String.format(
                                '<strong>Network Operator: </strong>%s<br />',
                                info.sim.operator_information
                            );

                            s += String.format(
                                '<strong>模式: </strong>%s<br />',
                                info.sim.system_information
                            );
                        }

                        if (ifc.uptime > 0) {
                            s += String.format(
                                '<strong>已连接: </strong>%t<br />',
                                ifc.uptime
                            );
                        }

                        ss.innerHTML = String.format('<small>%s</small>', s);
                        si.innerHTML = String.format(
                            '<img src="/luci-static/resources/icons/ethernet.png" />' +
                            // '<br /><small><a href="%s">%s</a></small>',
                            '<br /><small>%s</small>',
                            // ifc.link, ifc.ifname
                            ifc.ifname
                        );
                    } else {
                        si.innerHTML = '<img src="/luci-static/resources/icons/ethernet_disabled.png" /><br /><small>?</small>';
                        ss.innerHTML = '<em>未连接</em>';
                    }


                    var ls = document.getElementById('lease_status_table');
                    if (ls) {
                        /* clear all rows */
                        while (ls.rows.length > 1)
                            ls.rows[0].parentNode.deleteRow(1);

                        for (var i = 0; i < info.leases.length; i++) {
                            var timestr;

                            if (info.leases[i].expires <= 0)
                                timestr = '<em>过期时间</em>';
                            else
                                timestr = String.format('%t', info.leases[i].expires);

                            var tr = ls.rows[0].parentNode.insertRow(-1);
                            tr.className = 'cbi-section-table-row cbi-rowstyle-' + ((i % 2) + 1);

                            tr.insertCell(-1).innerHTML = info.leases[i].hostname ? info.leases[i].hostname : '?';
                            tr.insertCell(-1).innerHTML = info.leases[i].ipaddr;
                            tr.insertCell(-1).innerHTML = info.leases[i].macaddr;
                            tr.insertCell(-1).innerHTML = timestr;
                        }

                        if (ls.rows.length == 1) {
                            var tr = ls.rows[0].parentNode.insertRow(-1);
                            tr.className = 'cbi-section-table-row';

                            var td = tr.insertCell(-1);
                            td.colSpan = 4;
                            td.innerHTML = '<em><br />没有已分配的租约。</em>';
                        }
                    }

                    var ls6 = document.getElementById('lease6_status_table');
                    if (ls6 && info.leases6) {
                        ls6.parentNode.style.display = 'block';

                        /* clear all rows */
                        while (ls6.rows.length > 1)
                            ls6.rows[0].parentNode.deleteRow(1);

                        for (var i = 0; i < info.leases6.length; i++) {
                            var timestr;

                            if (info.leases6[i].expires <= 0)
                                timestr = '<em>过期时间</em>';
                            else
                                timestr = String.format('%t', info.leases6[i].expires);

                            var tr = ls6.rows[0].parentNode.insertRow(-1);
                            tr.className = 'cbi-section-table-row cbi-rowstyle-' + ((i % 2) + 1);

                            tr.insertCell(-1).innerHTML = info.leases6[i].hostname ? info.leases6[i].hostname : '?';
                            tr.insertCell(-1).innerHTML = info.leases6[i].ip6addr;
                            tr.insertCell(-1).innerHTML = info.leases6[i].duid;
                            tr.insertCell(-1).innerHTML = timestr;
                        }

                        if (ls6.rows.length == 1) {
                            var tr = ls6.rows[0].parentNode.insertRow(-1);
                            tr.className = 'cbi-section-table-row';

                            var td = tr.insertCell(-1);
                            td.colSpan = 4;
                            td.innerHTML = '<em><br />没有已分配的租约。</em>';
                        }
                    }


                    var e;

                    if (e = document.getElementById('localtime'))
                        e.innerHTML = info.localtime;

                    if (e = document.getElementById('uptime'))
                        e.innerHTML = String.format('%t', info.uptime);

                    if (e = document.getElementById('loadavg'))
                        e.innerHTML = String.format(
                            '%.02f, %.02f, %.02f',
                            info.loadavg[0] / 65535.0,
                            info.loadavg[1] / 65535.0,
                            info.loadavg[2] / 65535.0
                        );

                    if (e = document.getElementById('memtotal'))
                        e.innerHTML = progressbar(
                            ((info.memory.free + info.memory.buffered) / 1024) + " kB",
                            (info.memory.total / 1024) + " kB"
                        );

                    if (e = document.getElementById('memfree'))
                        e.innerHTML = progressbar(
                            (info.memory.free / 1024) + " kB",
                            (info.memory.total / 1024) + " kB"
                        );

                    if (e = document.getElementById('membuff'))
                        e.innerHTML = progressbar(
                            (info.memory.buffered / 1024) + " kB",
                            (info.memory.total / 1024) + " kB"
                        );

                    if (e = document.getElementById('swaptotal'))
                        e.innerHTML = progressbar(
                            (info.swap.free / 1024) + " kB",
                            (info.swap.total / 1024) + " kB"
                        );

                    if (e = document.getElementById('swapfree'))
                        e.innerHTML = progressbar(
                            (info.swap.free / 1024) + " kB",
                            (info.swap.total / 1024) + " kB"
                        );

                    if (e = document.getElementById('conns'))
                        e.innerHTML = progressbar(info.conncount, info.connmax);

                }
            );
            //]]></script>

            <h2><a id="content" name="content">状态</a></h2>

            <fieldset class="cbi-section">
                <legend>系统</legend>

                <table width="100%" cellspacing="10">
                    <tr>
                        <td width="33%">主机名</td>
                        <td>USR-G810</td>
                    </tr>
                    <!-- <tr><td width="33%">主机型号</td><td>mtk-apsoc-demo</td></tr>
                    <tr><td width="33%">固件版本</td><td>
                    OpenWrt Chaos Calmer 15.05.1 unknown /
                    LuCI develop-v1.0.00-mxw branch (git-20.271.35073-57d880c)
                  </td></tr>
                    <tr><td width="33%">内核版本</td><td>3.10.108</td></tr> -->
                    <tr>
                        <td width="33%">固件版本</td>
                        <td>V1.0.04

                        </td>
                    </tr>
                    <tr>
                        <td width="33%">本地时间</td>
                        <td id="localtime">-</td>
                    </tr>
                    <tr>
                        <td width="33%">运行时间</td>
                        <td id="uptime">-</td>
                    </tr>
                    <tr>
                        <td width="33%">平均负载</td>
                        <td id="loadavg">-</td>
                    </tr>
                </table>
            </fieldset>

            <fieldset class="cbi-section">
                <legend>内存</legend>

                <table width="100%" cellspacing="10">
                    <tr>
                        <td width="33%">可用数</td>
                        <td id="memtotal">-</td>
                    </tr>
                    <tr>
                        <td width="33%">空闲数</td>
                        <td id="memfree">-</td>
                    </tr>
                    <tr>
                        <td width="33%">已缓冲</td>
                        <td id="membuff">-</td>
                    </tr>
                </table>
            </fieldset>


            <fieldset class="cbi-section">
                <legend>网络</legend>

                <table width="100%" cellspacing="10">
                    <tr>
                        <td width="33%" style="vertical-align:top">IPv4 WAN状态</td>
                        <td>
                            <table>
                                <tr>
                                    <td id="wan4_i" style="width:16px; text-align:center; padding:3px"><img
                                            src="/luci-static/resources/icons/ethernet_disabled.png"/><br/><small>?</small>
                                    </td>
                                    <td id="wan4_s" style="vertical-align:middle; padding: 3px"><em>正在收集数据...</em>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>

                    <!-- <tr><td width="33%">活动连接</td><td id="conns">-</td></tr> -->
                </table>
            </fieldset>


            <fieldset class="cbi-section">
                <legend>DHCP分配</legend>

                <table class="cbi-section-table" id="lease_status_table">
                    <tr class="cbi-section-table-titles">
                        <th class="cbi-section-table-cell">主机名</th>
                        <th class="cbi-section-table-cell">IPv4地址</th>
                        <th class="cbi-section-table-cell">MAC-地址</th>
                        <th class="cbi-section-table-cell">剩余租期</th>
                    </tr>
                    <tr class="cbi-section-table-row">
                        <td colspan="4"><em><br/>正在收集数据...</em></td>
                    </tr>
                </table>
            </fieldset>


        </div>
    </div>
</div>
<!-- <footer class="footer">济南有人物联网技术有限公司&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.usr.cn/
">http://www.usr.cn/
</a></footer> -->
<footer class="footer">济南有人物联网技术有限公司&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.usr.cn/
                                                                              ">http://www.usr.cn/
</a></footer>
<script type="text/javascript">
    <!--
    var winWidth = 0;
    var winHeight = 0;

    function findDimensions() {
        if (window.innerWidth)
            winWidth = window.innerWidth;
        else if ((document.body) && (document.body.clientWidth))
            winWidth = document.body.clientWidth;
        if (window.innerHeight)
            winHeight = window.innerHeight;
        else if ((document.body) && (document.body.clientHeight))
            winHeight = document.body.clientHeight;
        if (document.documentElement && document.documentElement.clientHeight && document.documentElement.clientWidth) {
            winHeight = document.documentElement.clientHeight - 163;
            mainLeftHeight = document.documentElement.clientHeight - 183;
            mainLeftWidth = document.getElementById('main_left').offsetWidth;
            //这里减1，防止四舍五入计算导致页面超限
            mainRightWidth = document.body.clientWidth - mainLeftWidth - 1;
        }
        document.getElementById('main').style.height = winHeight + "px";
        document.getElementById('main_left').style.height = mainLeftHeight + "px";
        document.getElementById('main_left_head').style.height = mainLeftHeight + "px";
        document.getElementById('main_right').style.height = winHeight + "px";
        document.getElementById('main_right').style.width = mainRightWidth + "px";
    }

    findDimensions();
    window.onresize = findDimensions;
    //这里增加一个主动缩放检测函数定时执行(只需兼容ie8+系列)
    var deviceXDPI = screen.deviceXDPI;
    setInterval(function () {
        if (screen.deviceXDPI != deviceXDPI) {
            deviceXDPI = screen.deviceXDPI;
            //alert("test ctrl resize");
            findDimensions();
        }
    }, 300);
    //-->
</script>
</body>
</html>


